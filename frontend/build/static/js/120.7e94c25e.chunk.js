"use strict";(self.webpackChunkmyblog=self.webpackChunkmyblog||[]).push([[120],{120:(t,a,e)=>{e.r(a),e.d(a,{default:()=>n});var c=e(43),s=e(174),o=e(579);const n=function(){const[t,a]=(0,c.useState)([]),[e,n]=(0,c.useState)(!0),[r,i]=(0,c.useState)(null),l=(0,s.Zp)(),d=(0,c.useCallback)((async()=>{try{const t=localStorage.getItem("authToken"),e=await fetch("".concat("http://localhost:5000","/admin/contacts"),{headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)throw new Error("Failed to fetch contacts");const c=await e.json();a(c)}catch(t){i(t.message)}finally{n(!1)}}),[]),h=(0,c.useCallback)((async()=>{const t=localStorage.getItem("authToken");if(t)try{if(!(await fetch("".concat("http://localhost:5000","/auth/verify"),{headers:{Authorization:"Bearer ".concat(t)}})).ok)throw new Error("Authentication failed");d()}catch(a){localStorage.removeItem("authToken"),l("/login")}else l("/login")}),[l,d]);return(0,c.useEffect)((()=>{h()}),[h]),e?(0,o.jsx)("div",{className:"admin-loading",children:"Loading contacts..."}):r?(0,o.jsxs)("div",{className:"admin-error",children:["Error: ",r]}):(0,o.jsxs)("div",{className:"admin-dashboard",children:[(0,o.jsx)("h1",{children:"Contact Form Submissions"}),(0,o.jsxs)("div",{className:"contacts-list",children:[t.map((t=>(0,o.jsxs)("div",{className:"contact-card status-".concat(t.status),children:[(0,o.jsxs)("div",{className:"contact-header",children:[(0,o.jsx)("h3",{children:t.subject}),(0,o.jsx)("span",{className:"contact-date",children:new Date(t.createdAt).toLocaleDateString()})]}),(0,o.jsxs)("div",{className:"contact-info",children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"From:"})," ",t.name," (",t.email,")"]}),(0,o.jsx)("p",{className:"contact-message",children:t.message})]}),(0,o.jsxs)("div",{className:"contact-actions",children:[(0,o.jsxs)("select",{value:t.status,onChange:a=>(async(t,a)=>{try{const e=localStorage.getItem("authToken");if(!(await fetch("".concat("http://localhost:5000","/admin/contacts/").concat(t),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({status:a})})).ok)throw new Error("Failed to update contact status");d()}catch(e){i(e.message)}})(t._id,a.target.value),className:"status-select status-".concat(t.status),children:[(0,o.jsx)("option",{value:"unread",children:"Unread"}),(0,o.jsx)("option",{value:"read",children:"Read"}),(0,o.jsx)("option",{value:"responded",children:"Responded"})]}),(0,o.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this contact?"))try{const a=localStorage.getItem("authToken");if(!(await fetch("".concat("http://localhost:5000","/admin/contacts/").concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a)}})).ok)throw new Error("Failed to delete contact");d()}catch(a){i(a.message)}})(t._id),className:"delete-button",children:"Delete"})]})]},t._id))),0===t.length&&(0,o.jsx)("div",{className:"no-contacts",children:"No contact form submissions yet."})]})]})}}}]);
//# sourceMappingURL=120.7e94c25e.chunk.js.map